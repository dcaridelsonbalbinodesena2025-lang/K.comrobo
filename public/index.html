<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRAIN PRO - DASHBOARD</title>
    <style>
        :root {
            --primary: #00d4ff;
            --bg: #0a0e17;
            --card: #161b22;
            --text: #ffffff;
            --success: #00ff88;
            --danger: #ff4444;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            width: 100%;
            max-width: 1200px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--card);
            border-radius: 10px;
            border-bottom: 3px solid var(--primary);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1200px;
        }

        .ativo-card {
            background: var(--card);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid #30363d;
            transition: 0.3s;
        }

        .ativo-card:hover {
            border-color: var(--primary);
        }

        .ativo-nome {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }

        canvas {
            width: 100% !important;
            height: 200px !important;
            background: #000;
            border-radius: 5px;
        }

        .status-container {
            margin-top: 10px;
            display: flex;
            justify-content: space-around;
            font-size: 14px;
        }

        .btn-telegram {
            margin-top: 20px;
            background: #229ED9;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo">Brain Pro Multi-Ativos</div>
        <div id="relogio">00:00:00</div>
    </div>

    <div class="grid-container" id="monitor-grid">
        </div>

    <button class="btn-telegram">BOT TELEGRAM ATIVO ✅</button>

    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <script>
        // Lista de ativos
        const ativos = [
            { id: "R_100", nome: "Volatility 100" },
            { id: "R_75", nome: "Volatility 75" },
            { id: "R_50", nome: "Volatility 50" },
            { id: "R_25", nome: "Volatility 25" },
            { id: "R_10", nome: "Volatility 10" },
            { id: "1HZ100V", nome: "Volatility 100 (1s)" }
        ];

        const grid = document.getElementById('monitor-grid');
        const charts = {};

        // Criar os mini-gráficos para cada ativo
        ativos.forEach(ativo => {
            const card = document.createElement('div');
            card.className = 'ativo-card';
            card.innerHTML = `
                <div class="ativo-nome">${ativo.nome}</div>
                <div id="chart_${ativo.id}"></div>
                <div class="status-container">
                    <span id="preco_${ativo.id}">Carregando...</span>
                </div>
            `;
            grid.appendChild(card);

            const chart = LightweightCharts.createChart(document.getElementById(`chart_${ativo.id}`), {
                width: 330,
                height: 200,
                layout: { backgroundColor: '#000', textColor: '#fff' },
                grid: { vertLines: { color: '#1f1f1f' }, horzLines: { color: '#1f1f1f' } },
                timeScale: { timeVisible: true, secondsVisible: true }
            });

            charts[ativo.id] = chart.addCandlestickSeries();
            
            // Conectar ao WebSocket da Deriv para atualizar o visual
            const ws = new WebSocket('wss://ws.binaryws.com/websockets/v3?app_id=1089');
            ws.onopen = () => {
                ws.send(JSON.stringify({
                    ticks_history: ativo.id,
                    end: "latest",
                    count: 50,
                    style: "candles",
                    granularity: 60,
                    subscribe: 1
                }));
            };

            ws.onmessage = (msg) => {
                const res = JSON.parse(msg.data);
                if (res.candles) {
                    const data = res.candles.map(c => ({
                        time: c.epoch,
                        open: c.open,
                        high: c.high,
                        low: c.low,
                        close: c.close
                    }));
                    charts[ativo.id].setData(data);
                }
                if (res.ohlc) {
                    charts[ativo.id].update({
                        time: res.ohlc.open_time,
                        open: parseFloat(res.ohlc.open),
                        high: parseFloat(res.ohlc.high),
                        low: parseFloat(res.ohlc.low),
                        close: parseFloat(res.ohlc.close)
                    });
                    document.getElementById(`preco_${ativo.id}`).innerText = `Preço: ${res.ohlc.close}`;
                }
            };
        });

        // Relógio
        setInterval(() => {
            document.getElementById('relogio').innerText = new Date().toLocaleTimeString();
        }, 1000);
    </script>
</body>
</html>
